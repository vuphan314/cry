\subsection{Class Diagrams}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{tikzpicture}
\umlenum{CryptosystemName}{rsa}{}
\umltypedef[right=0.5in of CryptosystemName]{Key}{mpz\_t}{}
\umltypedef[right=0.5in of Key]{Text}{string}{}
\umlclass[below=0.3in of Text]{Cryptosystem}{}
  {\umlvirt{+ generateKeys(publicKey: Key, privateKey: Key):
    void} \\
  \umlvirt{+ encrypt(ciphertext: Text,
    plaintext: Text, publicKey: Key): void} \\
  \umlvirt{+ decrypt(plaintext: Text,
    ciphertext: Text, privateKey: Key): void} \\
  \umlvirt{+ cryptanalyze(plaintext: Text,
    ciphertext: Text, publicKey: Key): void}}
\umlclass[below=0.3in of Cryptosystem]{Rsa}{}
  {+ generateKeys(publicKey: Key, privateKey: Key): void \\
  + encrypt(ciphertext: Text,
    plaintext: Text, publicKey: Key): void \\
  + decrypt(plaintext: Text,
    ciphertext: Text, privateKey: Key): void \\
  + cryptanalyze(plaintext: Text,
    ciphertext: Text, publicKey: Key): void}
\umlinherit{Rsa}{Cryptosystem}
\umlclass[below=3.5in of CryptosystemName]{Party}
  {+ cryptosystem: Cryptosystem}
  {+ Party(cryptosystemName: CryptosystemName)}
\umlaggreg[anchors=90 and 180]{Party}{Cryptosystem}
\umlclass[right=1.6in of Party]{Receiver}
  {+ publicKey: Key \\
  -- privateKey: Key \\
  -- plaintext: Text}
  {-- generateKeys(): void \\
  -- decrypt(ciphertext: Text): void}
\umlclass[below=0.3in of Receiver]{Sender}
  {+ ciphertext: Text \\
  -- plaintext: Text}
  {-- encrypt(publicKey: Key): void}
\umlclass[below=0.3in of Sender]{Eavesdropper}
  {-- plaintext: Text}
  {-- cryptanalyze(ciphertext: Text, publicKey: Key): void}
\umlinherit[anchors=180 and 10]{Receiver}{Party}
\umlinherit[anchors=180 and 0]{Sender}{Party}
\umlinherit[anchors=180 and -10]{Eavesdropper}{Party}
\end{tikzpicture}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
