\subsection{Class Diagrams}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{tikzpicture}
\umlenum{CryptosystemName}{rsa}{}
\umltypedef[right=0.5in of CryptosystemName]{Key}{mpz\_t}{}
\umltypedef[right=0.5in of Key]{Text}{string}{}
\umlclass[below=0.5in of Key]{Cryptosystem}{}
  {+ Cryptosystem(cryptosystemName: CryptosystemName) \\
  \umlvirt{+ generateKeys(publicKey: Key, privateKey: Key):
    void} \\
  \umlvirt{+ encrypt(ciphertext: Text,
    plaintext: Text, publicKey: Key): void} \\
  \umlvirt{+ decrypt(plaintext: Text,
    ciphertext: Text, privateKey: Key): void} \\
  \umlvirt{+ cryptanalyze(plaintext: Text,
    ciphertext: Text, publicKey: Key): void}}
  \umldep[anchors=90 and -90]{Cryptosystem}{CryptosystemName}
  \umldep[anchors=90 and -90]{Cryptosystem}{Key}
  \umldep[anchors=90 and -90]{Cryptosystem}{Text}
\umlclass[below left=0.5in and -2in of Cryptosystem]{Rsa}{}
  {+ generateKeys(publicKey: Key, privateKey: Key): void \\
  + encrypt(ciphertext: Text,
    plaintext: Text, publicKey: Key): void \\
  + decrypt(plaintext: Text,
    ciphertext: Text, privateKey: Key): void \\
  + cryptanalyze(plaintext: Text,
    ciphertext: Text, publicKey: Key): void}
  \umlinherit[anchors=90 and -164]{Rsa}{Cryptosystem}
\umlclass[below right=2in and -3in of Cryptosystem]{Party}
  {# cryptosystem: Cryptosystem}
  {+ Party(cryptosystemName: CryptosystemName)}
  \umlaggreg[anchors=90 and -50]{Party}{Cryptosystem}
\umlclass[below=0.5in of Rsa]{Receiver}
  {+ publicKey: Key \\
  -- privateKey: Key \\
  -- plaintext: Text}
  {-- generateKeys(): void \\
  -- decrypt(ciphertext: Text): void}
  \umlinherit[anchors=0 and 180]{Receiver}{Party}
\umlclass[below=0.5in of Receiver]{Sender}
  {+ ciphertext: Text \\
  -- plaintext: Text}
  {-- encrypt(publicKey: Key): void}
  \umlinherit[anchors=0 and -160]{Sender}{Party}
\umlclass[below=0.5in of Sender]{Eavesdropper}
  {-- plaintext: Text}
  {-- cryptanalyze(ciphertext: Text, publicKey: Key): void}
  \umlinherit[anchors=0 and -90]{Eavesdropper}{Party}
\end{tikzpicture}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
